import{u as x,r as d,j as s,h as j,R as D,a3 as S,L as T,d as U}from"./index-59f2354e.js";import{P as F}from"./container-03e214f9.js";import{D as P,T as V,a as b}from"./index-28f81481.js";import{g as O}from"./utils-4a35f25f.js";import{T as Y}from"./Table-4c07d154.js";import{d as k}from"./dayjs.min-36613c82.js";import{C as $,c as G}from"./data-8b3ff740.js";import{F as i,m as E,A as R}from"./motion-db2b8b92.js";import{S as h}from"./index-9f2fb8c4.js";import{I as o}from"./index-dc7f8182.js";import{B as y}from"./button-d04776d9.js";import{n as q}from"./index-eaf1928d.js";import{M as z}from"./index-394ef855.js";import{u as H}from"./UseRegionDatabords-31b186c5.js";import"./index-95885a2b.js";import"./PurePanel-e5ac0afe.js";import"./DownOutlined-43a19ddf.js";import"./collapse-97de76d4.js";import"./index-c51833f7.js";import"./InfoCircleFilled-23b8bc08.js";import"./CloseCircleFilled-f69f152a.js";function B({data:e,isLoading:t,onViewDetails:n}){const{state:a,actions:l}=x(),u=d.useMemo(()=>[{title:"Subscription Country",dataIndex:"country",key:"country",render:c=>s.jsx("span",{children:O(c)})},{title:"Standard Rate ($)",dataIndex:"standard_rate",key:"standard_rate"},{title:"Advanced Rate ($)",dataIndex:"advanced_rate",key:"advanced_rate"},{title:"Premium Rate ($)",dataIndex:"premium_rate",key:"premium_rate"},{title:"Last Updated",dataIndex:"last_updated",key:"last_updated"},{title:"Tag",dataIndex:"tags",key:"tags"},{title:"Show New Tag",dataIndex:"newly_launched",key:"newly_launched"},{title:"",dataIndex:"action",key:"action",render:(c,m)=>j(a.user,"canEditDataboard")?s.jsx("div",{onClick:()=>n(m),className:"text-blue-700 flex items-center  gap-2 cursor-pointer",children:"Edit"}):null}],[]);return s.jsx(s.Fragment,{children:s.jsx(Y,{columns:u,loading:t,dataSource:e||[],pagination:!1})})}const K=(e,t)=>({country:e.country_id,advanced_dark_databoard_url:e.dark_mode_a,advanced_light_databoard_url:e.light_mode_s,advanced_rate:e.advance_subscription_rate,standard_dark_databoard_url:e.dark_mode_s,standard_light_databoard_url:e.light_mode_s,standard_rate:e.standard_subscription_rate,premium_dark_databoard_url:e.dark_mode_p,premium_light_databoard_url:e.light_mode_p,premium_rate:e.premium_subscription_rate,newly_launched:e.new_country,last_updated:k(e.last_updated).format("YYYY-MM-DD HH:mm:ss"),created_by_id:t.created_by_id,tags:Array.isArray(e.tags)?e.tags.join(", "):e.tags||""}),J=e=>({country_id:e==null?void 0:e.country,standard_subscription_rate:parseFloat(e==null?void 0:e.standard_rate),advance_subscription_rate:parseFloat(e==null?void 0:e.advanced_rate),premium_subscription_rate:parseFloat(e==null?void 0:e.premium_rate),dark_mode_a:e==null?void 0:e.advanced_dark_databoard_url,light_mode_a:e==null?void 0:e.advanced_light_databoard_url,dark_mode_s:e==null?void 0:e.standard_dark_databoard_url,light_mode_s:e==null?void 0:e.standard_light_databoard_url,light_mode_p:e==null?void 0:e.premium_light_databoard_url,dark_mode_p:e==null?void 0:e.premium_dark_databoard_url,last_updated:k(e==null?void 0:e.last_updated),new_country:e==null?void 0:e.newly_launched,tags:e==null?void 0:e.tags.split(",")}),Q=(e,t)=>({name:e.name,advanced_rate:e.advanced_rate,premium_rate:e.premium_rate,standard_rate:e.standard_rate,created_by_id:t.created_by_id}),W=e=>({name:e==null?void 0:e.name,advanced_rate:e==null?void 0:e.advanced_rate,premium_rate:e==null?void 0:e.premium_rate,standard_rate:e==null?void 0:e.standard_rate});function X({onSubmit:e,isSubmitting:t,dashboard:n,errorMessage:a}){const[l]=i.useForm(),u=c=>{e(c)},r=d.useMemo(()=>J(n),[n]);return s.jsxs(i,{layout:"vertical",requiredMark:!1,name:"sign-form",className:"w-full",form:l,initialValues:r,onFinish:u,children:[s.jsx(E.div,{initial:{opacity:0,marginBottom:0},animate:{opacity:a?1:0,marginBottom:a?10:0},children:s.jsx(R,{type:"error",showIcon:!0,message:a})}),s.jsx($,{placeholder:"Select a country",name:"country_id",label:"Country",loading:!1,countries:G}),s.jsx(i.Item,{label:"Select Tags",name:"tags",rules:[{required:!0,message:"This field is required"}],children:s.jsxs(h,{placeholder:"Select tag(s) ",mode:"multiple",allowClear:!0,size:"large",children:[s.jsx(h.Option,{value:"Imports",children:"Imports"}),s.jsx(h.Option,{value:"Vessel Traking",children:"Vessel Traking"}),s.jsx(h.Option,{value:"Tenders",children:"Tenders"})]})}),s.jsx("p",{className:" font-medium text-base mb-1 mt-5",children:"Standard Subscription"}),s.jsxs("div",{className:"border-solid-200 border shadow-sm rounded-sm border-dashed p-5",children:[s.jsx(i.Item,{label:"Annual Rate",name:"standard_subscription_rate",rules:[{required:!0,message:"This field is required!"}],children:s.jsx(o,{placeholder:"Enter Annual Rate",type:"number"})}),s.jsxs("div",{className:"grid grid-cols-2 gap-5",children:[s.jsx(i.Item,{name:"light_mode_s",label:"Light Mode Dashboard Url",rules:[{required:!0,message:"This field is required!"},{type:"url",message:"Enter a valid URL"}],children:s.jsx(o,{placeholder:" Light Mode Dashboard Url"})}),s.jsx(i.Item,{name:"dark_mode_s",label:"Dark Mode Dashboard Url",rules:[{required:!0,message:"This field is required!"},{type:"url",message:"Enter a valid URL"}],children:s.jsx(o,{placeholder:" Dark Mode Dashboard Url"})})]})]}),s.jsx("p",{className:" font-medium text-base mt-7 mb-1 ",children:"Advanced Subscription"}),s.jsxs("div",{className:"border-solid-200 border shadow-sm rounded-sm border-dashed p-5",children:[s.jsx(i.Item,{label:"Annual Rate",name:"advance_subscription_rate",rules:[{required:!0,message:"This field is required!"}],children:s.jsx(o,{placeholder:"Enter Annual Rate",type:"number"})}),s.jsxs("div",{className:"grid grid-cols-2 gap-5",children:[s.jsx(i.Item,{name:"light_mode_a",label:"Light Mode Dashboard Url",rules:[{required:!0,message:"This field is required!"},{type:"url",message:"Enter a valid URL"}],children:s.jsx(o,{placeholder:" Light Mode Dashboard Url"})}),s.jsx(i.Item,{name:"dark_mode_a",label:"Dark Mode Dashboard Url",rules:[{required:!0,message:"This field is required!"},{type:"url",message:"Enter a valid URL"}],children:s.jsx(o,{placeholder:" Dark Mode Dashboard Url"})})]})]}),s.jsx("p",{className:" font-medium text-base mt-7 mb-1",children:"Premium Subscription"}),s.jsxs("div",{className:"border-solid-200 border shadow-sm rounded-sm border-dashed p-5",children:[s.jsx(i.Item,{label:"Annual Rate",name:"premium_subscription_rate",rules:[{required:!0,message:"This field is required!"}],children:s.jsx(o,{placeholder:"Enter Annual Rate",type:"number"})}),s.jsxs("div",{className:"grid grid-cols-2 gap-5",children:[s.jsx(i.Item,{name:"light_mode_p",label:"Light Mode Dashboard Url",rules:[{required:!0,message:"This field is required!"},{type:"url",message:"Enter a valid URL"}],children:s.jsx(o,{placeholder:" Light Mode Dashboard Url"})}),s.jsx(i.Item,{name:"dark_mode_p",label:"Dark Mode Dashboard Url",rules:[{required:!0,message:"This field is required!"},{type:"url",message:"Enter a valid URL"}],children:s.jsx(o,{placeholder:"Dark Mode Dashboard Url"})})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-5 pt-5 mt-2",children:[s.jsx(i.Item,{label:"Last Updated",name:"last_updated",rules:[{required:!0,message:"This field is required!"}],children:s.jsx(P,{placeholder:"Last Updated",className:"w-full"})}),s.jsx(i.Item,{name:"new_country",label:"Is New Country?",rules:[{required:!0,message:"This field is required!"}],children:s.jsxs(h,{placeholder:"Yes or No",children:[s.jsx(h.Option,{value:"Yes",children:"Yes"}),s.jsx(h.Option,{value:"No",children:"No"})]})})]}),s.jsx(y,{type:"primary",htmlType:"submit",loading:t,className:"w-full mt-5",children:"Submit"})]})}function Z(){const[e,t]=d.useState(""),{mutate:n,isPending:a,isSuccess:l,isError:u}=D({method:"save",model:"databoards",onSuccess:r=>{q.success({message:"Databoard saved successfully",placement:"topRight"})},onError:r=>{console.log(r),t("Error creating databoard")}});return d.useEffect(()=>{if(e){const r=setTimeout(()=>t(""),5e3);return()=>{clearTimeout(r)}}},[e]),{state:{isLoading:a,errorMessage:e,isSuccess:l,isError:u},actions:{setErrorMessage:t,saveDataboard:n}}}const ee=({enabled:e=!0}={})=>S({method:"list",model:"databoards",enabled:e});function se(){const{data:e,isLoading:t,refetch:n}=ee(),[a,l]=d.useState(void 0),[u,r]=d.useState(!1),{state:c,actions:m}=x(),[f,I]=d.useState(""),[w,v]=d.useState(e);d.useEffect(()=>{e&&v(e)},[e]);const M=_=>{const g=_.target.value;I(g);const L=e==null?void 0:e.filter(C=>C.country.toLowerCase().includes(g.toLowerCase()));v(L)},A=_=>{l(_),r(!0)},p=Z(),N=_=>{const g=K(_,{created_by_id:(a==null?void 0:a.created_by_id)??c.user.id});p.actions.saveDataboard({body:g,id:a==null?void 0:a.id},{onSuccess(){n()}})};return d.useEffect(()=>{p.state.isSuccess&&r(!1)},[p.state.isSuccess]),s.jsx(s.Fragment,{children:t?s.jsx(T,{}):s.jsxs("div",{className:"px-2  pb-2 overflow-hidden ",children:[s.jsxs("div",{className:"flex py-3 justify-between items-center",children:[s.jsx(o,{value:f,onChange:M,placeholder:"Search",className:"max-w-4xl"}),j(c.user,"canAddDataboard")&&s.jsx(y,{onClick:()=>r(!0),className:"bg-green-500 rounded-lg p-4 m-2 text-white flex items-center justify-center",icon:s.jsx(U,{}),children:"Add"})]}),s.jsx(B,{data:w,isLoading:!1,onViewDetails:A}),s.jsx(z,{centered:!0,width:700,footer:null,open:u,title:a?"Edit Dashboard":"Add DataBoard",onCancel:()=>{r(!1),l(void 0)},className:"bg-black",destroyOnClose:!0,children:s.jsx(X,{dashboard:a,onSubmit:N,isSubmitting:p.state.isLoading,errorMessage:p.state.errorMessage})})]})})}const ae=()=>S({model:"vw_region_databoards",method:"list"});function te({onSubmit:e,isSubmitting:t,errorMessage:n,regionBoard:a}){const[l]=i.useForm();ae();const{state:u}=x(),r=f=>{e(f)},c=d.useMemo(()=>W(a),[a]),m=j(u.user,"canEditFullAccess");return s.jsxs(i,{layout:"vertical",requiredMark:!1,name:"add-databoard-form",className:"w-full",initialValues:c,form:l,onFinish:r,children:[s.jsx(E.div,{initial:{opacity:0,marginBottom:0},animate:{opacity:n?1:0,marginBottom:n?10:0},children:s.jsx(R,{type:"error",showIcon:!0,message:n})}),s.jsx(i.Item,{label:"Region",name:"name",rules:[{required:!0,message:"This field is required!"}],children:s.jsx(o,{placeholder:"Enter Region",disabled:!m})}),s.jsx(i.Item,{label:"Standard Annual Rate ($)",name:"standard_rate",rules:[{required:!0,message:"This field is required!"}],children:s.jsx(o,{placeholder:"Enter standard annual rate",type:"number",disabled:!m})}),s.jsx(i.Item,{label:"Advanced Annual Rate ($)",name:"advanced_rate",rules:[{required:!0,message:"This field is required!"}],children:s.jsx(o,{placeholder:"Enter advanced annual rate",type:"number",disabled:!m})}),s.jsx(i.Item,{label:"Premium Annual Rate ($)",name:"premium_rate",rules:[{required:!0,message:"This field is required!"}],children:s.jsx(o,{placeholder:"Enter premium annual rate",type:"number",disabled:!m})}),m&&s.jsx(y,{type:"primary",loading:t,htmlType:"submit",className:"w-full mt-5",children:"Submit"})]})}function re(){const[e,t]=d.useState(""),{mutate:n,isPending:a,isSuccess:l,isError:u}=D({method:"save",model:"regions",onSuccess:r=>{q.success({message:"Databoard saved successfully",placement:"topRight"})},onError:r=>{console.log(r),t("Error creating databoard")}});return d.useEffect(()=>{if(e){const r=setTimeout(()=>t(""),5e3);return()=>{clearTimeout(r)}}},[e]),{state:{isLoading:a,errorMessage:e,isSuccess:l,isError:u},actions:{setErrorMessage:t,saveRegionBoard:n}}}function ie(){const{data:e,isLoading:t}=H(),{state:n,actions:a}=x();d.useState("");const l=re(),u=r=>{const c=Q(r,{created_by_id:n.user.id});l.actions.saveRegionBoard({body:c})};return s.jsxs("div",{className:"max-w-3xl",children:[t&&s.jsx(T,{}),e&&s.jsx(te,{regionBoard:e[0],onSubmit:u,isSubmitting:l.state.isLoading,errorMessage:l.state.errorMessage})]})}function Ee(){const[e,t]=d.useState("1"),n=a=>{t(a)};return s.jsx(F,{title:"Manage Databoards",children:s.jsx("div",{className:"px-2  pb-2 overflow-hidden ",children:s.jsxs(V,{activeKey:e,onChange:n,children:[s.jsx(b,{tab:s.jsx("span",{className:e==="1"?"text-[#2BA94C]":"text-content-default",children:"Individual Access"}),children:s.jsx(se,{})},"1"),s.jsx(b,{tab:s.jsx("span",{className:e==="2"?"text-[#2BA94C]":"text-content-default",children:"Full Access"}),children:s.jsx(ie,{})},"2")]})})})}export{Ee as default};
