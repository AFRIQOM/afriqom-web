import{aq as I,r,j as e,u as A,a2 as _,h as D,d as L}from"./index-59f2354e.js";import{U as B}from"./dto-0c8e3693.js";import{P}from"./container-03e214f9.js";import{S as T}from"./StatusTag-0f6e5003.js";import{T as z}from"./Table-4c07d154.js";import{u as V,E as O,U as F}from"./UserSuccessModal-8dd7e792.js";import{I as G}from"./index-dc7f8182.js";import{B as R}from"./button-d04776d9.js";import{M as q}from"./index-394ef855.js";import"./utils-4a35f25f.js";import"./index-0b338665.js";import"./index-9f2fb8c4.js";import"./DownOutlined-43a19ddf.js";import"./PurePanel-e5ac0afe.js";import"./CloseCircleFilled-f69f152a.js";import"./index-95885a2b.js";import"./collapse-97de76d4.js";import"./index-c51833f7.js";import"./useOrganizationHandler-a9522fa4.js";import"./useGetSubscriptionsView-43e8743f.js";import"./motion-db2b8b92.js";import"./InfoCircleFilled-23b8bc08.js";import"./index-eaf1928d.js";function H(o){return I({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 105c-101.8 0-188.4 62.4-224 151 35.6 88.6 122.2 151 224 151s188.4-62.4 224-151c-35.6-88.6-122.2-151-224-151zm0 251.7c-56 0-101.8-45.3-101.8-100.7S200 155.3 256 155.3 357.8 200.6 357.8 256 312 356.7 256 356.7zm0-161.1c-33.6 0-61.1 27.2-61.1 60.4s27.5 60.4 61.1 60.4 61.1-27.2 61.1-60.4-27.5-60.4-61.1-60.4z"}}]})(o)}function J({data:o,isLoading:n,onViewDetails:d}){r.useState(!1);const s=r.useMemo(()=>[{title:"Name",dataIndex:"full_name",key:"full_name",render:(t,c,m)=>e.jsxs("div",{className:"flex items-center gap-2",children:[t,m===0&&e.jsx("div",{className:"bg-blue-500 text-white text-xs md:text-md rounded-md p-1",children:"Main Contact"})]})},{title:"Email",dataIndex:"email",key:"email"},{title:"Role",dataIndex:"account_type",key:"account_type"},{title:"Status",dataIndex:"status",key:"status",width:"16%",render:t=>e.jsx(T,{status:t})},{title:"",dataIndex:"action",key:"action",render:(t,c)=>e.jsxs("div",{onClick:()=>d(c),className:"text-blue-700 flex items-center justify-center gap-2 cursor-pointer",children:[e.jsx(H,{}),"Edit"]})}],[]);return e.jsx(z,{scroll:{x:900},columns:s,loading:n,dataSource:o||[],pagination:!1})}function Se(){const[o,n]=r.useState(!1),{state:d}=A(),[s,l]=r.useState(void 0),{data:t,isLoading:c,refetch:m}=_({params:{access_portal:"backend"}}),[f,h]=r.useState(""),[K,u]=r.useState(t),{actions:{saveUser:S,setNewUsername:g,setNewPassword:w,setOpenSuccessModal:p},state:{newPassword:U,openSuccessModal:j,newUsername:y,isLoading:M,errorMessage:b}}=V(),C=a=>{l(a),n(!0)},E=a=>{const i=B({...a,status:a.status??(s==null?void 0:s.status)},{access_portal:"backend"});S({body:i,id:s==null?void 0:s.id},{onSuccess(){m(),g(a.email),w(a.password),n(!1),a.password&&p(!0)}})},v=()=>{n(!0)};r.useEffect(()=>{t&&u(t)},[t]);const N=a=>{const i=a.target.value;h(i);const k=t==null?void 0:t.filter(x=>x.full_name.toLowerCase().includes(i.toLowerCase())||x.email.toLowerCase().includes(i.toLowerCase()));u(k)};return e.jsxs(P,{title:"Manage System Users",children:[e.jsxs("div",{className:"flex py-3 justify-between items-center",children:[e.jsx(G,{value:f,onChange:N,placeholder:"Search",className:"max-w-4xl"}),D(d.user,"canAddAccountUser")&&e.jsx(R,{className:"bg-green-500 text-white",icon:e.jsx(L,{}),onClick:v,children:"Add"})]}),e.jsx(J,{data:t,isLoading:c,onViewDetails:C}),e.jsx(q,{centered:!0,width:600,footer:null,open:o,destroyOnClose:!0,title:s?"Edit User":"Add User",className:"modal header",onCancel:()=>{n(!1),l(void 0)},children:e.jsx(O,{user:s,onSubmit:E,isSubmitting:M,errorMessage:b,isAdminUser:!0})}),e.jsx(F,{openSuccessModal:j,newPassword:U,newUsername:y,setOpenSuccessModal:p})]})}export{Se as default};
